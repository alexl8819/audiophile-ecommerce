---
import Layout from '../layouts/Layout.astro';
import Header from '../components/Header';
import Footer from '../components/Footer.astro';
import { CheckoutPreview } from '../components/Checkout';
import { NavigationButton, NavigationMethod } from '../components/Button';
import { FLAT_SHIPPING_RATE } from '../lib/constants';
import { cartItems } from '../stores/cart';

// TODO: implement server-side validation
if (!Object.keys(cartItems.get()).length) {
	return Astro.redirect('/');
}

const amountDue = 2000;
---
<Layout subtitle="Checkout">
	<Header navLinks={[
		{ name: 'Home', url: '/' }, 
		{ name: 'Headphones', url: '/headphones' }, 
		{ name: 'Speakers', url: '/speakers' }, 
		{ name: 'Earphones', url: '/earphones' }
	]} styles={{ backgroundColor: 'bg-black' }} client:load />
	<main class="py-24 md:py-28 mb-[116px] bg-white lg:bg-light-gray">
		<div class="mt-2 mx-6 lg:mx-40">
			<NavigationButton method={NavigationMethod.Back} client:load>Back</NavigationButton>
		</div>
		<section class="my-4 mx-6 lg:mx-40">
			<h1 class="uppercase font-bold text-[28px] tracking-[1px] mb-8 mx-8 lg:mx-0 lg:w-2/3 lg:px-12 lg:py-8 lg:rounded-lg bg-white">Checkout</h1>
			<CheckoutPreview amountDue={amountDue} shippingCost={amountDue * FLAT_SHIPPING_RATE} client:load />
		</section>
	</main>
	<Footer navLinks={[
		{ name: 'Home', url: '/' }, 
		{ name: 'Headphones', url: '/headphones' }, 
		{ name: 'Speakers', url: '/speakers' }, 
		{ name: 'Earphones', url: '/earphones' }
	]} showAbout={false} />
</Layout>
